<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<title>Strefa Fotografa</title>
<style>
body { font-family: Arial; background:#f5f5f5; margin:0; padding:0; }
header { background:#ff6b6b; color:white; text-align:center; padding:15px; font-size:1.5em; }
.panel { background:white; margin:20px auto; padding:20px; max-width:800px; border-radius:10px; box-shadow:0 3px 8px rgba(0,0,0,0.1);}
input,button,select { width:100%; padding:10px; margin:5px 0; border-radius:5px; border:1px solid #ccc;}
button { background:#ff6b6b; color:white; border:none; cursor:pointer;}
button:hover { background:#ff3b3b;}
.photo { display:inline-block; margin:5px; text-align:center;}
.photo img { width:120px; height:80px; object-fit:cover; border-radius:5px; display:block; margin-bottom:5px;}
</style>
</head>
<body>
<header>ðŸ“¸ Strefa Fotografa</header>

<div id="loginPanel" class="panel">
<h2>Logowanie</h2>
<input type="text" id="login" placeholder="Login">
<input type="password" id="haslo" placeholder="HasÅ‚o">
<button onclick="zaloguj()">Zaloguj</button>
</div>

<div id="fotografPanel" class="panel" style="display:none;">
<h2>Panel Fotografa</h2>
<h3>Sesje</h3>
<select id="selectSession"></select>
</div>

<div id="klientPanel" class="panel" style="display:none;">
<h2>Panel Klienta</h2>
<div id="sesjeKlienta"></div>
<h3>Koszyk</h3>
<div id="koszyk"></div>
<input type="text" id="koszykKod" placeholder="Kod rabatowy">
<button onclick="kupZdjecia()">Kup zdjÄ™cia</button>
</div>

<script src="data.js"></script>
<script>
let loggedUser=null;
let koszyk=[];

function zaloguj(){
  const login=document.getElementById("login").value;
  const haslo=document.getElementById("haslo").value;
  const user=users.find(u=>u.login===login && u.haslo===haslo);
  if(!user){ alert("BÅ‚Ä™dny login lub hasÅ‚o!"); return; }
  loggedUser=user;
  document.getElementById("loginPanel").style.display="none";
  if(user.type==="fotograf"){ document.getElementById("fotografPanel").style.display="block"; aktualizujSelectSesji(); }
  else { document.getElementById("klientPanel").style.display="block"; pokazSesjeKlienta(); }
}

// WyÅ›wietlanie sesji w panelu fotografa
function aktualizujSelectSesji(){
  const select=document.getElementById("selectSession"); select.innerHTML="";
  sessions.forEach((s,i)=>{
    const opt=document.createElement("option");
    opt.value=i; opt.textContent=`${s.name} (${s.client})`;
    select.appendChild(opt);
  });
}

// WyÅ›wietlanie sesji klienta
function pokazSesjeKlienta(){
  const div=document.getElementById("sesjeKlienta"); div.innerHTML="";
  const moje=sessions.filter(s=>s.client===loggedUser.login);
  moje.forEach(s=>{
    const panel=document.createElement("div"); panel.className="panel";
    panel.innerHTML=`<h3>${s.name}</h3>`;
    s.photos.forEach((p,i)=>{
      const photoDiv=document.createElement("div"); photoDiv.className="photo";
      photoDiv.innerHTML=`<img src="${p}" alt="ZdjÄ™cie"><button onclick="dodajDoKoszyka(${sessions.indexOf(s)},${i})">Wybieram</button>`;
      panel.appendChild(photoDiv);
    });
    div.appendChild(panel);
  });
}

// Koszyk
function dodajDoKoszyka(sessionIndex,photoIndex){
  const s=sessions[sessionIndex];
  const photo=s.photos[photoIndex];
  if(!koszyk.find(k=>k.photo===photo)) koszyk.push({photo:photo,session:s});
  aktualizujKoszyk();
}

function aktualizujKoszyk(){
  const div=document.getElementById("koszyk"); div.innerHTML="";
  if(koszyk.length===0) return;
  const s=koszyk[0].session;
  let wybrane=koszyk.length;
  let dodatkowe=Math.max(0,wybrane-s.freePhotos);
  let suma=dodatkowe*s.extraPrice;
  const kod=document.getElementById("koszykKod").value.trim();
  if(kod && kod===s.discountCode) suma=Math.max(0,suma-s.discountValue);
  koszyk.forEach(item=>{
    const photoDiv=document.createElement("div"); photoDiv.className="photo";
    photoDiv.innerHTML=`<img src="${item.photo}" alt="ZdjÄ™cie">`;
    div.appendChild(photoDiv);
  });
  const info=document.createElement("div");
  info.innerHTML=`<p>Wybranych zdjÄ™Ä‡: <b>${wybrane}</b></p><p>Dodatkowe zdjÄ™cia: <b>${dodatkowe}</b></p><p>Do zapÅ‚aty: <b>${suma} zÅ‚</b></p>`;
  div.appendChild(info);
}

function kupZdjecia(){ alert("Zakup zakoÅ„czony!"); koszyk=[]; aktualizujKoszyk(); }
</script>
</body>
</html>
